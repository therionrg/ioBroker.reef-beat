{
  "version": 3,
  "sources": ["../src/reefBeatApi.ts"],
  "sourcesContent": ["import axios from \"axios\";\nimport { IReefBeat } from \"./types\";\n\ninterface ReefBeatData {\n\tsources: Source[];\n\tlocal?: any;\n}\n\ninterface Source {\n\tname: string;\n\ttype: \"device-info\" | \"config\" | \"data\" | \"preview\";\n\tdata: any;\n}\n\nexport class ReefBeatApi {\n\tprotected adapter: IReefBeat;\n\tprotected ip: string;\n\tprotected baseUrl: string;\n\tprotected secure: boolean;\n\tpublic data: ReefBeatData;\n\tprotected headers: { [key: string]: string } = {};\n\n\tconstructor(ip: string, secure: boolean = false, adapter: IReefBeat) {\n\t\tthis.ip = ip;\n\t\tthis.secure = secure;\n\t\tthis.baseUrl = (secure ? \"https://\" : \"http://\") + ip;\n\t\tthis.adapter = adapter;\n\n\t\tthis.data = {\n\t\t\tsources: [\n\t\t\t\t{ name: \"/device-info\", type: \"device-info\", data: null },\n\t\t\t\t{ name: \"/firmware\", type: \"device-info\", data: null },\n\t\t\t\t{ name: \"/mode\", type: \"config\", data: null },\n\t\t\t\t{ name: \"/cloud\", type: \"config\", data: null },\n\t\t\t\t{ name: \"/wifi\", type: \"data\", data: null },\n\t\t\t\t{ name: \"/dashboard\", type: \"data\", data: null },\n\t\t\t],\n\t\t};\n\t}\n\n\t// GET Request\n\tpublic async httpGetAsync(path: string): Promise<any | null> {\n\t\tconst url = this.baseUrl + path;\n\t\ttry {\n\t\t\tthis.adapter.log.info(`GET ${url}`);\n\n\t\t\t// axios verwendet 'data' f\u00FCr den Response-Body\n\t\t\tconst resp = await axios.get(url, { headers: this.headers });\n\t\t\treturn resp.data;\n\t\t} catch (ex: any) {\n\t\t\tconst status = ex.response ? ex.response.status : \"N/A\";\n\t\t\tthis.adapter.log.error(`GET ${path} failed (Status: ${status}): ${ex.message}`);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t// POST/PUT Request (verwendet axios)\n\tprotected async httpSendAsync(path: string, payload: any, method: \"POST\" | \"PUT\"): Promise<boolean> {\n\t\tconst url = this.baseUrl + path;\n\t\ttry {\n\t\t\tthis.adapter.log.debug(`${method} ${url} Payload: ${JSON.stringify(payload)}`);\n\n\t\t\tawait axios({\n\t\t\t\tmethod: method,\n\t\t\t\turl: url,\n\t\t\t\theaders: {\n\t\t\t\t\t...this.headers,\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t\tdata: payload,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t} catch (ex: any) {\n\t\t\tconst status = ex.response ? ex.response.status : \"N/A\";\n\t\t\tthis.adapter.log.error(`${method} ${path} failed (Status: ${status}): ${ex.message}`);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tpublic async getDataAsync<T = any>(sourceName: string): Promise<T | null> {\n\t\tconst source = this.data.sources.find((s) => s.name === sourceName);\n\t\tif (!source) return null;\n\n\t\tconst result = await this.httpGetAsync(sourceName);\n\t\tthis.adapter.log.info(`Data from ${sourceName}: ${JSON.stringify(result)}`);\n\t\tif (result) source.data = result;\n\n\t\treturn source.data as T;\n\t}\n\n\tpublic async fetchAllDataAsync(): Promise<void> {\n\t\tfor (const source of this.data.sources) {\n\t\t\tawait this.getDataAsync(source.name);\n\t\t}\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAkB;AAcX,MAAM,YAAY;AAAA,EACd;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACH;AAAA,EACG,UAAqC,CAAC;AAAA,EAEhD,YAAY,IAAY,SAAkB,OAAO,SAAoB;AACpE,SAAK,KAAK;AACV,SAAK,SAAS;AACd,SAAK,WAAW,SAAS,aAAa,aAAa;AACnD,SAAK,UAAU;AAEf,SAAK,OAAO;AAAA,MACX,SAAS;AAAA,QACR,EAAE,MAAM,gBAAgB,MAAM,eAAe,MAAM,KAAK;AAAA,QACxD,EAAE,MAAM,aAAa,MAAM,eAAe,MAAM,KAAK;AAAA,QACrD,EAAE,MAAM,SAAS,MAAM,UAAU,MAAM,KAAK;AAAA,QAC5C,EAAE,MAAM,UAAU,MAAM,UAAU,MAAM,KAAK;AAAA,QAC7C,EAAE,MAAM,SAAS,MAAM,QAAQ,MAAM,KAAK;AAAA,QAC1C,EAAE,MAAM,cAAc,MAAM,QAAQ,MAAM,KAAK;AAAA,MAChD;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAGA,MAAa,aAAa,MAAmC;AAC5D,UAAM,MAAM,KAAK,UAAU;AAC3B,QAAI;AACH,WAAK,QAAQ,IAAI,KAAK,OAAO,GAAG,EAAE;AAGlC,YAAM,OAAO,MAAM,aAAAA,QAAM,IAAI,KAAK,EAAE,SAAS,KAAK,QAAQ,CAAC;AAC3D,aAAO,KAAK;AAAA,IACb,SAAS,IAAS;AACjB,YAAM,SAAS,GAAG,WAAW,GAAG,SAAS,SAAS;AAClD,WAAK,QAAQ,IAAI,MAAM,OAAO,IAAI,oBAAoB,MAAM,MAAM,GAAG,OAAO,EAAE;AAC9E,aAAO;AAAA,IACR;AAAA,EACD;AAAA;AAAA,EAGA,MAAgB,cAAc,MAAc,SAAc,QAA0C;AACnG,UAAM,MAAM,KAAK,UAAU;AAC3B,QAAI;AACH,WAAK,QAAQ,IAAI,MAAM,GAAG,MAAM,IAAI,GAAG,aAAa,KAAK,UAAU,OAAO,CAAC,EAAE;AAE7E,gBAAM,aAAAA,SAAM;AAAA,QACX;AAAA,QACA;AAAA,QACA,SAAS;AAAA,UACR,GAAG,KAAK;AAAA,UACR,gBAAgB;AAAA,QACjB;AAAA,QACA,MAAM;AAAA,MACP,CAAC;AAED,aAAO;AAAA,IACR,SAAS,IAAS;AACjB,YAAM,SAAS,GAAG,WAAW,GAAG,SAAS,SAAS;AAClD,WAAK,QAAQ,IAAI,MAAM,GAAG,MAAM,IAAI,IAAI,oBAAoB,MAAM,MAAM,GAAG,OAAO,EAAE;AACpF,aAAO;AAAA,IACR;AAAA,EACD;AAAA,EAEA,MAAa,aAAsB,YAAuC;AACzE,UAAM,SAAS,KAAK,KAAK,QAAQ,KAAK,CAAC,MAAM,EAAE,SAAS,UAAU;AAClE,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,SAAS,MAAM,KAAK,aAAa,UAAU;AACjD,SAAK,QAAQ,IAAI,KAAK,aAAa,UAAU,KAAK,KAAK,UAAU,MAAM,CAAC,EAAE;AAC1E,QAAI,OAAQ,QAAO,OAAO;AAE1B,WAAO,OAAO;AAAA,EACf;AAAA,EAEA,MAAa,oBAAmC;AAC/C,eAAW,UAAU,KAAK,KAAK,SAAS;AACvC,YAAM,KAAK,aAAa,OAAO,IAAI;AAAA,IACpC;AAAA,EACD;AACD;",
  "names": ["axios"]
}
